---
title: 目录结构
description: 仓库目录、工作区与文档结构总览
editLink: true
outline: deep
---

# 目录结构

> [!NOTE]
> CSISP 是一个基于 pnpm workspace 与 Turbo 的 Monorepo。顶层通过脚本与工作区协同管理应用、共享包、基础设施与文档。

## 顶层目录与工作区

- `apps/*`：可独立运行的应用
  - `backend-integrated`：核心后端集成服务（NestJS），承担主要业务与数据访问
  - `bff`：聚合编排层（Koa），面向前端的接口组合与错误映射
  - `backoffice`：后台系统（Next.js App Router + Ant Design），JSON-RPC 统一入口与管理模块
  - `frontend-admin`：中台前端（Vue3 + Vite）
  - `frontend-portal`：门户前端（Vue3 + Vite）
- `packages/*`：共享能力
  - `types`：统一类型与 DTO（复用于多项目）
  - `utils`：通用工具与环境读取等
- `infra/*`：基础设施与契约
  - `database`：数据库脚本（迁移、状态、种子）、docker compose 与初始化脚本
  - `idl`：Thrift IDL 与生成脚本（多项目共享类型）
- `docs/*`：文档站点（VitePress）
  - `.vitepress/config.ts`：站点导航与侧边栏（顺序由数组声明控制）
  - `src/*`：五个一级目录（入门指南/架构设计/开发指南/基础设施与基建/模块详解）
- `tests/*`：测试工作区（当前尚未撰写）

## 应用与模块关系

- `backend-integrated`：项目综合后端，承载业务与数据访问（PostgreSQL、Redis、Mongo）
  - 导航入口：[backend-integrated](/src/模块详解/backend-integrated/架构与目录)
- `bff`：前端场景的接口编排与规范化错误映射
  - 导航入口：[bff](/src/模块详解/bff/架构与目录)
- `backoffice`：后台管理系统，管理日志、数据库、分权、埋点等信息
  - 导航入口：[backoffice](/src/模块详解/backoffice/架构与目录)
- `frontend-admin`：中台前端，路由与页面组织、状态与接口协作
  - 导航入口：[frontend-admin](/src/模块详解/frontend-admin/架构与目录)
- `frontend-portal`：门户前端，页面组织与接口协作最佳实践
  - 导航入口：[frontend-portal](/src/模块详解/frontend-portal/架构与目录)

## apps 项目目录结构

- `backend-integrated/`
  - `src/common/`：装饰器、守卫、拦截器、管道、RPC 统一处理
  - `src/infra/`：`postgres/models/*`、`redis/*`、`mongo/*` 客户端与模型
  - `src/modules/`：`health/*` 等业务模块
  - `main.ts`、`app.module.ts`：应用入口与模块装配
  - `scripts/run-kanel.ts`：数据库类型生成辅助脚本
- `bff/`
  - `src/infra/`：Redis、日志等基础封装
  - `src/middleware/`：CORS、鉴权、限流、错误、响应校验、日志、追踪
  - `src/modules/`：`admin/*`、`portal/*` 聚合接口
  - `src/rpc/`：分发、注册与 OpenRPC 类型
  - `app.ts`：应用入口
- `backoffice/`
  - `app/`：Next.js App Router 路由与 API（`api/backoffice/[domain]/[action]/route.ts` 等）
  - `src/client/`：前端客户端（导航、UI、样式、工具）
  - `src/server/`：中间件、鉴权、配置、模块与 RPC 分发
  - `src/infra/`：`postgres/*`、`redis/*`、`mongo/*` 客户端与封装
  - `scripts/run-kanel.ts`：数据库类型生成辅助脚本
- `frontend-admin/`
  - `src/api/*`：接口定义与请求封装
  - `src/components/*`、`src/pages/*`、`src/layouts/*`：页面与组件组织
  - `src/router/*`、`src/stores/*`、`src/types/*`：路由、状态、类型
  - `main.ts`、`App.vue`：应用入口
- `frontend-portal/`
  - `src/assets/*`：静态资源
  - `main.ts`、`App.vue`：应用入口

## 共享包与基础设施

- `packages/types`：统一类型声明与 DTO，提升跨项目协作的类型一致性
- `packages/utils`：环境变量读取等通用工具
- `infra/database`：
  - 脚本示例：`src/cli/db-migrate.ts`、`db-reset-dev.ts`、`db-status.ts`、`db-rollback.ts`、`db-seed-mongo.ts`
  - 迁移与种子：`src/migrations/*`、`src/seed/*`
  - 初始化脚本：`scripts/init_mac.sh`、`init_linux.sh`、`init_windows.bat`
- `infra/idl`：
  - 生成脚本：`scripts/config.sh`、`gen-ts.sh`、`gen-js.sh`
  - IDL 目录：`src/<project>/v1/*.thrift`

## 关联脚本与约定

- 根脚本（摘录）：
  - `dev:infra`：初始化数据库（`db:init`）与生成 Thrift 类型（`idl:gen`）
  - `dev:backend-integrated`：生成数据库类型（`db:types`），再启动后端开发服务
  - `dev:backoffice`：生成数据库类型（`db:types`），再启动后台开发服务
  - `dev:bff`：启动 Koa 聚合层
  - `dev:admin` / `dev:portal`：分别启动中台与门户前端
- 文档站点：
  - 预览：`pnpm --filter @csisp/docs dev`
  - 构建：`pnpm --filter @csisp/docs build`（撰写后需执行一次构建校验）

> [!TIP]
> 建议先阅读[环境搭建](/src/入门指南/环境搭建)与[快速开始](/src/入门指南/快速开始)，再进入“模块详解”查看各子项目的架构与实践。
