---
title: 技术栈选型
description: 栈组成、契约与数据层选择及取舍
editLink: true
outline: deep
---

# 技术栈选型

> [!NOTE]
> 本项目统一采用 TypeScript 与单一的 OpenRPC/JSON-RPC 接口范式；`method` 由路由标识（`/api/[project?]/[subproject?]/:domain/:action`），不在请求体中使用 `method` 字段。

## 语言与框架

| 模块                 | 框架与组件                                                                 | 路由/页面                                   | 主要用途                       | 版本示例                          |
| -------------------- | -------------------------------------------------------------------------- | ------------------------------------------- | ------------------------------ | --------------------------------- |
| `backend-integrated` | `TypeScript`、`NestJS`、`sequelize` / `sequelize-typescript`、`mongoose`   | `POST /api/:domain/:action`                 | 后端集成与数据访问、中间件治理 | TS^5.9、Nest^10、sequelize^6.x    |
| `bff`                | `TypeScript`、`Koa`、`@koa/router`、`zod`、`redis`                         | `POST /api/bff/:subproject/:domain/:action` | 聚合编排、错误映射、限流与路由 | Koa^3.1、router^14、zod^3.23      |
| `backoffice`         | `TypeScript`、`Next.js`、`Ant Design`、`sequelize`、`ioredis`、`mongoose`  | `POST /api/backoffice/:domain/:action`      | 全栈后台系统、管理与内部接口   | next^15、antd^5.18、sequelize^6.x |
| `frontend-admin`     | `TypeScript`、`Vue3`、`Vite`、`Pinia`、`Vue Router`、`Naive UI`、`ECharts` | 前端路由与页面                              | 中台前端、表格/图表与交互      | vue^3.5、vite^5.4、pinia^2.1      |
| `frontend-portal`    | `TypeScript`、`Vue3`、`Vite`、`Pinia`、`Vue Router`、`Naive UI`、`ECharts` | 前端路由与页面                              | 门户前端、可视化展示与交互     | vue^3.5、vite^5.4、echarts^5.5    |

## 数据与缓存

| 技术                                 | 范围/模块                                | 主要用途       | 关键点/备注                                     | 版本示例                  |
| ------------------------------------ | ---------------------------------------- | -------------- | ----------------------------------------------- | ------------------------- |
| `PostgreSQL` + `pg`                  | infra/db、backend-integrated、backoffice | 关系型数据库   | 读多写少、索引与查询优化                        | ^8.11–8.12                |
| `Sequelize` / `sequelize-typescript` | infra/db、backend-integrated、backoffice | ORM 与模型定义 | 迁移配合 `Umzug`；<br />Nest 集成               | sequelize^6.x、types^2.1  |
| `Umzug`                              | infra/db                                 | 迁移执行       | 版本化迁移与状态管理                            | ^3.8                      |
| `Redis`（`redis` / `ioredis`）       | bff、backoffice、backend-integrated      | 缓存与限流     | bff 用 `redis`^4.6；backoffice 用 `ioredis`^5.3 | 见模块                    |
| `MongoDB` / `Mongoose`               | backoffice、backend-integrated           | 内容/日志/i18n | 非结构化内容与记录                              | mongodb^6.8、mongoose^8–9 |

## 通用库与工具

| 技术                                | 范围/模块                       | 主要用途               | 关键点/备注                             | 版本示例                                   |
| ----------------------------------- | ------------------------------- | ---------------------- | --------------------------------------- | ------------------------------------------ |
| `Pino` / `pino-pretty`              | 多模块                          | 日志记录与输出美化     | 统一格式、开发可读性                    | pino^9.x                                   |
| `Zod` / `class-validator`           | bff / backend-integrated        | 参数与响应校验         | `Zod`（BFF）、`class-validator`（Nest） | zod^3.23、cv^0.14                          |
| `JSON Web Token`                    | 多模块                          | 认证与会话             | 令牌验证、角色判定                      | jsonwebtoken^9.0                           |
| `Axios` / `Undici`                  | frontends / bff                 | HTTP 客户端            | 前端 / Node 双栈                        | axios^1.6、undici^6.19                     |
| `Day.js`                            | backoffice                      | 时间处理               | 轻量日期处理                            | ^1.11                                      |
| `Sass`                              | 前端与 backoffice               | 样式                   | 变量与 mixins                           | ^1.69                                      |
| `Esbuild` / `TSX` / `Nodemon`       | 多模块                          | 构建与运行             | 轻量构建与开发启动                      | esbuild^0.19、tsx^4、nodemon^3             |
| `Kanel`                             | backoffice / backend-integrated | DB 类型生成            | 基于 schema 生成 TS 模型类型            | ^3.x                                       |
| `ESLint` / `Prettier` / `Stylelint` | 全项目                          | 代码质量与风格         | Flat config、Vue/Sass 适配              | ESLint^9.39、Prettier^3.6、Stylelint^16.25 |
| `Turbo` / `pnpm`                    | 根工作流                        | 多项目脚本编排与包管理 | workspace + pipeline                    | turbo^2.7、pnpm@10.22                      |
| `VitePress` / `Mermaid`             | 文档                            | 站点与图示             | 不使用页面 TOC；容器与图示规范          | ^1.6、^2.0                                 |

## 关键技术补充说明

- Thrift IDL 与类型共享：IDL 由 `infra/idl` 统一维护，`idl:gen` 生成后在 `bff/backoffice/backend-integrated` 复用，避免类型分歧
- Sequelize + Umzug：迁移与模型分离，使用 Umzug 管理版本化迁移；通过 Kanel 生成数据库类型，提升类型安全
- Redis 客户端差异：`redis`（BFF）与 `ioredis`（Backoffice）各有侧重，统一以命名空间与 TTL 控制策略，并在中间件层封装限流
- 日志栈：Pino 统一格式，配合 `pino-pretty` 提升开发可读性；生产可接入集中式日志平台
- Monorepo 工作流：以 Turbo 驱动 `dev:*` 与 `build`；pnpm workspace 保证依赖与脚本在多模块的一致性
